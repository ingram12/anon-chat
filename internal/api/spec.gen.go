// Package api provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.4.1 DO NOT EDIT.
package api

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
